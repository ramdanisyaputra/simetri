import{x as E,r as g,j as e}from"./app-CLY3Rrsu.js";import{D as K,a as M,b as R,c as V,d as I}from"./dialog-lUksT3GM.js";import{S as u,a as h,b as x,c as p,d as j}from"./select-pyEKviHf.js";import{B as v}from"./button-BS65-JNH.js";import{I as b}from"./input-CoVvPQ80.js";import{L as d}from"./label-Be86QqRv.js";import{D as k,T as L}from"./date-input-BcD5Mnt0.js";import{B as z}from"./badge-omXVK4Z0.js";import{A as H,a as J}from"./arrow-up-Rh-3TcdK.js";import{c as $}from"./utils-DLMB8ej9.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],W=$("ArrowRight",U);function G({open:o,onOpenChange:m,mode:n,recurringTransaction:r,accounts:N,categories:w,onSuccess:c}){const{data:s,setData:l,post:D,put:B,processing:f,errors:t,reset:_}=E({account_id:"",category_id:"",type:"",amount:"",description:"",frequency:"",day_of_month:"",start_date:"",end_date:""}),F=[{value:"income",label:"Pemasukan",icon:H,color:"text-green-600"},{value:"expense",label:"Pengeluaran",icon:J,color:"text-red-600"},{value:"transfer",label:"Transfer",icon:W,color:"text-blue-600"}],C=[{value:"daily",label:"Harian"},{value:"weekly",label:"Mingguan"},{value:"monthly",label:"Bulanan"},{value:"yearly",label:"Tahunan"}],q=a=>a?w.filter(i=>i.type===a):[],A=a=>{const i=String(a).replace(/\D/g,"");return i?i.replace(/\B(?=(\d{3})+(?!\d))/g,"."):""},P=a=>a.replace(/\./g,""),S=a=>{const i=P(a);l("amount",i)},T=a=>{a.preventDefault(),n==="create"?D(route("recurring-transactions.store"),{onSuccess:()=>{m(!1),c==null||c()},onError:()=>{}}):n==="edit"&&r&&B(route("recurring-transactions.update",r.id),{onSuccess:()=>{m(!1),c==null||c()},onError:()=>{}})};return g.useEffect(()=>{if(n==="edit"&&r&&o){const a=String(r.amount).replace(".00",""),i=y=>y?y.split("T")[0]:"";l({account_id:String(r.account_id),category_id:String(r.category_id||""),type:r.type,amount:a,description:r.description||"",frequency:r.frequency,day_of_month:String(r.day_of_month||""),start_date:i(r.start_date),end_date:r.end_date?i(r.end_date):""})}else n==="create"&&o&&_()},[n,r,o]),g.useEffect(()=>{o||_()},[o]),e.jsx(K,{open:o,onOpenChange:m,children:e.jsxs(M,{className:"sm:max-w-lg max-h-[90vh] overflow-y-auto mx-4 w-[calc(100vw-2rem)] sm:w-full",children:[e.jsxs(R,{children:[e.jsx(V,{className:"text-lg sm:text-xl",children:n==="create"?"Tambah Transaksi Berulang Baru":"Edit Transaksi Berulang"}),e.jsx(I,{className:"text-sm",children:n==="create"?"Atur transaksi yang akan berjalan secara otomatis sesuai jadwal.":"Perbarui informasi transaksi berulang Anda."})]}),e.jsxs("form",{onSubmit:T,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(d,{htmlFor:"type",children:"Jenis Transaksi"}),e.jsxs(u,{value:s.type,onValueChange:a=>{l("type",a),l("category_id","")},children:[e.jsx(h,{children:e.jsx(x,{placeholder:"Pilih jenis transaksi"})}),e.jsx(p,{children:F.map(a=>e.jsx(j,{value:a.value,children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(a.icon,{className:`mr-2 h-4 w-4 ${a.color}`}),a.label]})},a.value))})]}),t.type&&e.jsx("p",{className:"text-sm text-red-600",children:t.type})]}),e.jsxs("div",{children:[e.jsx(d,{htmlFor:"account",children:"Akun"}),e.jsxs(u,{value:s.account_id,onValueChange:a=>l("account_id",a),children:[e.jsx(h,{children:e.jsx(x,{placeholder:"Pilih akun"})}),e.jsx(p,{children:N.map(a=>e.jsx(j,{value:String(a.id),children:a.name},a.id))})]}),t.account_id&&e.jsx("p",{className:"text-sm text-red-600",children:t.account_id})]}),e.jsxs("div",{children:[e.jsx(d,{htmlFor:"category",children:"Kategori"}),e.jsxs(u,{value:s.category_id,onValueChange:a=>l("category_id",a),disabled:s.type==="transfer"||!s.type,children:[e.jsx(h,{children:e.jsx(x,{placeholder:s.type==="transfer"?"Transfer tidak memerlukan kategori":s.type?"Pilih kategori":"Pilih jenis transaksi terlebih dahulu"})}),e.jsx(p,{children:q(s.type).map(a=>e.jsx(j,{value:String(a.id),children:e.jsxs("div",{className:"flex items-center gap-2",children:[a.icon&&e.jsx("span",{children:a.icon}),a.name,a.user_id!==null&&e.jsx(z,{variant:"outline",className:"text-xs ml-2",children:"Kategori Kustom"})]})},a.id))})]}),t.category_id&&e.jsx("p",{className:"text-sm text-red-600",children:t.category_id})]}),e.jsxs("div",{children:[e.jsx(d,{htmlFor:"amount",children:"Jumlah"}),e.jsx(b,{id:"amount",type:"text",value:A(s.amount),onChange:a=>S(a.target.value),placeholder:"0"}),t.amount&&e.jsx("p",{className:"text-sm text-red-600",children:t.amount})]}),e.jsxs("div",{children:[e.jsx(d,{htmlFor:"frequency",children:"Frekuensi"}),e.jsxs(u,{value:s.frequency,onValueChange:a=>l("frequency",a),children:[e.jsx(h,{children:e.jsx(x,{placeholder:"Pilih frekuensi"})}),e.jsx(p,{children:C.map(a=>e.jsx(j,{value:a.value,children:a.label},a.value))})]}),t.frequency&&e.jsx("p",{className:"text-sm text-red-600",children:t.frequency})]}),(s.frequency==="monthly"||s.frequency==="yearly")&&e.jsxs("div",{children:[e.jsx(d,{htmlFor:"day_of_month",children:"Tanggal dalam Bulan"}),e.jsx(b,{id:"day_of_month",type:"number",min:"1",max:"31",value:s.day_of_month,onChange:a=>l("day_of_month",a.target.value),placeholder:"1-31"}),t.day_of_month&&e.jsx("p",{className:"text-sm text-red-600",children:t.day_of_month})]}),e.jsxs("div",{children:[e.jsx(d,{htmlFor:"start_date",children:"Tanggal Mulai"}),e.jsx(k,{id:"start_date",value:s.start_date,onChange:a=>l("start_date",a)}),t.start_date&&e.jsx("p",{className:"text-sm text-red-600",children:t.start_date})]}),e.jsxs("div",{children:[e.jsx(d,{htmlFor:"end_date",children:"Tanggal Berakhir (Opsional)"}),e.jsx(k,{id:"end_date",value:s.end_date,onChange:a=>l("end_date",a)}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Kosongkan jika tidak ada batas waktu"}),t.end_date&&e.jsx("p",{className:"text-sm text-red-600",children:t.end_date})]}),e.jsxs("div",{children:[e.jsx(d,{htmlFor:"description",children:"Keterangan"}),e.jsx(L,{id:"description",value:s.description,onChange:a=>l("description",a.target.value),placeholder:"Keterangan opsional...",rows:3}),t.description&&e.jsx("p",{className:"text-sm text-red-600",children:t.description})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-end space-y-2 sm:space-y-0 sm:space-x-2",children:[e.jsx(v,{type:"button",variant:"outline",onClick:()=>m(!1),className:"w-full sm:w-auto",children:"Batal"}),e.jsx(v,{type:"submit",disabled:f,className:"w-full sm:w-auto",children:f?n==="create"?"Menambahkan...":"Memperbarui...":n==="create"?"Tambah Transaksi Berulang":"Perbarui Transaksi Berulang"})]})]})]})})}const le=Object.freeze(Object.defineProperty({__proto__:null,default:G},Symbol.toStringTag,{value:"Module"}));export{W as A,G as R,le as a};
